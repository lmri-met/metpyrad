Overview of Hidex 300 SL
========================

The Hidex 300 SL
----------------

The **Hidex 300 SL** is a an automatic liquid scintillation counter
with an automatic sample changer and a triple photomultiplier tube detection assembly.
It is used to measure the activity of liquid scintillation samples.

Key features of the Hidex 300 SL:

- **Automatic sample changer**:
  Typical scintillation vials are loaded in sample racks.
  A robotic loading arm transfer the vials from the sample racks to the measurement chamber.
- **Triple-PMT detector technology**:
  It utilizes three PMTs aligned at 120Â° from each other with a highly reflective measurement chamber design.
  This provide optimal measurement geometry and maximises light collection.
  Its lead shield design provides good shielding, minimizes instrument weight, and reduces background effects.
- **TDCR tecnology**:
  Absolute activity counting using triple-to-double coincidence ratio (TDCR) method.
  It also supports using an external standard method.
- **Temperature stabilization**:
  It supports measurement at a controlled temperature optimal for the scintillation cocktails used.

Find more details about this instrument in the
`Hidex website <https://www.hidex.com/products/liquid-scintillation-counters/hidex-300-sl>`_.

Measuring with the Hidex 300 SL
--------------------------------

One of the common uses of the Hidex 300 SL in radionuclide metrology
is to measure the activity of a radionuclide in terms of time.
This type of measure allows to see how the activity of the radionuclide decays over time.
From such a measure you can derive important quantities that characterize the radionuclide being measured.
One of this quantities is the half-life (:math:`t_{1/2}`),
which is the time taken for the activity of a given radionuclide to decay to half of its initial value.

This measure involves making repeated measurements of the radionuclide in the same conditions along several days.
So this measure is really a set of measurements.
This set of measurements consists on a number of cycles of measurement, each one with a number of repetitions.
Each repetition consists on measuring the sample of the radionuclide and background (a measurement without sample)
during a specific period of time.

.. code-block::

    Cicle 1
        Repetition 1
            Background measurement
            Sample measurement
        Repetition 2
            Background measurement
            Sample measurement
        ...
        Repetition n
            Background measurement
            Sample measurement
    Cicle 2
        Repetition 1
            Background measurement
            Sample measurement
        Repetition 2
            Background measurement
            Sample measurement
        ...
        Repetition n
            Background measurement
            Sample measurement
    ...
    Cicle n
        Repetition 1
            Background measurement
            Sample measurement
        Repetition 2
            Background measurement
            Sample measurement
        ...
        Repetition n
            Background measurement
            Sample measurement

To make such a set of measurements, you can program the Hidex 300 SL,
configuring the number of repetitions per cycle and the measurement time per repetition.
For each cicle of measurements, the Hidex 300 SL provides a CSV file with the results of the measurements.

This type of measurement may be time consuming. For example, take the
`Lutetium-177 radionuclide <https://www.advancingnuclearmedicine.com/knowledgebase/nuclear-medicine-facts/lutetium-177>`_.
It is commonly used in targeted radionuclide therapy for treating neuroendocrine tumours and prostate cancer.
It is a medium-energy beta emitter with an energy of 0.149 MeV.
It also emits low-energy gamma rays, which are useful for imaging and dosimetry.
It has a half-life of about 6.7 days, which is long enough to allow for transportation and preparation of
pharmaceuticals, but short enough to minimize long-term radiation exposure.

A typical measurement of this radionuclide to determine its radioactive decay over time
involves measuring one or two cycles per day during a month.
Each cycle may have about 20 - 30 repetitions of background/sample measurements during 100 seconds.
So you may end up with a total of 1200 - 3600 measurements,
33 - 100 hours of measurement time
and 30 - 60 CSV output files from the Hidex 300 SL.

Output files of the Hidex 300 SL
--------------------------------

Here you can see an example of the CSV file generated by the Hidex 300 SL for a single cycle of measurement.
Note that it is not a complete file, it is just a part of it extracted for illustration purposes.

.. code-block::
    :linenos:

    Lu-177 HS3 301123_ciclo1
    Start Time 8:40:58
    - ROI1 Free Channel Limits 1 - 1023, Type Beta
    Counting type: Low
    Sample start
    Samp.;1
    Repe.;1
    Vial;1
    WName;A01
    CPM;83.970
    DPM;126
    TDCR;0.664
    Chemi;0.380
    Counts;140
    DTime;1.000
    Time;100
    EndTime;30/11/2023 08:44:20
    QPE;786.730
    QPI;350.220
    LumiCPS;276
    Temp;24.10
    Column 17;0
    Column 18;0
    Column 19;0
    Column 20;0
    Spectrum:;Alpha;Beta;Alpha Triple;Beta Triple
    1;0;0;0;0
    2;0;0;0;0
    (...)
    1023;0;0;0;0
    1024;0;0;0;0
    Alpha:
    0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0
    0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0
    (...)
    0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0
    0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0
    Sample start
    Samp.;1
    Repe.;2
    Vial;1
    WName;A01
    CPM;87.570
    DPM;136
    TDCR;0.644
    Chemi;0.360
    Counts;146
    DTime;1.000
    Time;100
    EndTime;30/11/2023 08:51:04
    QPE;789.760
    QPI;385.770
    LumiCPS;269
    Temp;24.10
    Column 17;0
    Column 18;0
    Column 19;0
    Column 20;0
    Spectrum:;Alpha;Beta;Alpha Triple;Beta Triple
    1;0;0;0;0
    2;0;0;0;0
    (...)
    1023;0;0;0;0
    1024;0;0;0;0
    Alpha:
    0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0
    0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0
    (...)
    0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0
    0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0
    Sample start
    Samp.;2
    Repe.;1
    Vial;8
    WName;A08
    CPM;252623.230
    DPM;258604
    TDCR;0.977
    Chemi;121.370
    Counts;374237
    DTime;1.125
    Time;100
    EndTime;30/11/2023 08:47:44
    QPE;786.950
    QPI;453.020
    LumiCPS;4900
    Temp;24.10
    Column 17;0
    Column 18;0
    Column 19;0
    Column 20;0
    Spectrum:;Alpha;Beta;Alpha Triple;Beta Triple
    1;0;0;0;0
    2;0;0;0;0
    (...)
    1023;0;0;0;0
    1024;0;0;0;0
    Alpha:
    0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0
    0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0
    (...)
    0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0
    0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0
    Sample start
    Samp.;2
    Repe.;2
    Vial;8
    WName;A08
    CPM;251953.090
    DPM;257849
    TDCR;0.977
    Chemi;119.120
    Counts;373593
    DTime;1.124
    Time;100
    EndTime;30/11/2023 08:54:28
    QPE;786.670
    QPI;452.950
    LumiCPS;4855
    Temp;24.10
    Column 17;0
    Column 18;0
    Column 19;0
    Column 20;0
    Spectrum:;Alpha;Beta;Alpha Triple;Beta Triple
    1;0;0;0;0
    2;0;0;0;0
    (...)
    1023;0;0;0;0
    1024;0;0;0;0
    Alpha:
    0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0
    0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0
    (...)
    0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0
    0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0

File structure
^^^^^^^^^^^^^^

The file is structured with header information about the measurement cycle followed by
a series of repeated blocks of information for each background/sample measurement.

.. code-block::

    Cicle ID information
    Block 1:   Repetition 1, background measurement
    Block 2:   Repetition 2, background measurement
    ...
    Block n:   Repetition n, background measurement
    Block n+1: Repetition 1, sample measurement
    Block n+2: Repetition 2, sample measurement
    ...
    Block n+n: Repetition n, sample measurement

File contents
^^^^^^^^^^^^^^

The header information contains information about the measurement cycle, like a title, start time, ROI channel limits, and counting type.

.. code-block::
    :linenos:

    Lu-177 HS3 301123_ciclo1
    Start Time 8:40:58
    - ROI1 Free Channel Limits 1 - 1023, Type Beta
    Counting type: Low

In the series of repeated blocks of information,
the key words "Sample start" indicate the beginning of a block of background/sample measurement information.
Each block is structured with sample details (sample number, repetition, vial...),
measurement data (count rate, counts, time parameters, quenching parameters...) and spectrum data for alpha and beta particles.

.. code-block::
    :linenos:

    Sample start
    Samp.;1
    Repe.;1
    Vial;1
    WName;A01
    CPM;83.970
    DPM;126
    TDCR;0.664
    Chemi;0.380
    Counts;140
    DTime;1.000
    Time;100
    EndTime;30/11/2023 08:44:20
    QPE;786.730
    QPI;350.220
    LumiCPS;276
    Temp;24.10
    Column 17;0
    Column 18;0
    Column 19;0
    Column 20;0
    Spectrum:;Alpha;Beta;Alpha Triple;Beta Triple
    1;0;0;0;0
    2;0;0;0;0
    (...)
    1023;0;0;0;0
    1024;0;0;0;0
    Alpha:
    0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0
    0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0
    (...)
    0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0
    0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0

Quantities of interest from the Hidex 300 SL
--------------------------------------------

In this section we summarize the quantities of interest for characterizing the radioactive decay over time for a radionuclide.
It shows which of tese quantities can be found in the output CSV files provided by the Hidex 300 SL automatic scintillator counter.
It also shows how to obtain the rest of them, including uncertainty determination.

Measured quantities
^^^^^^^^^^^^^^^^^^^

Suppose we have a set of :math:`n` measurements for the background and a set of another :math:`n` measurements for the sample.
For each measurement :math:`i` of the background and sample, the Hidex 300 SL provides the next quantities of interest
for characterizing the radioactive decay over time for a radionuclide:

**Measurement time**, :math:`t_r`:
    The total duration for which the sample is measured, expressed in seconds (`s`).
    It is the time interval during which the detector is actively counting events.
    It is labeled as ``Time`` in the Hidex 300 SL output CSV file.

**Measurement end time**, :math:`t_{end}`:
    The specific time at which the measurement is completed, expressed in `d/m/yr h:min:s`.
    It marks the end of the measurement period.
    It is labeled as ``EndTime`` in the Hidex 300 SL output CSV file.

**Dead time**, :math:`t_d`:
    The period after each detected event during which the detector is unable to record another event.
    This is due to the time required for the detector to reset and be ready for the next event.
    It is expressed as factor :math:`\ge 1`, with 1 meaning there is no dead time in the measurement.
    It is labeled as ``DTime`` in the Hidex 300 SL output CSV file.

**Count rate**, :math:`C_r`:
    The number of counts detected per unit time, expressed in counts per minute (`cpm`).
    It indicates the activity level of the sample being measured.
    It is labeled as ``CPM`` in the Hidex 300 SL output CSV file.

Derived quantities
^^^^^^^^^^^^^^^^^^

Now, for each measurement :math:`i` of the background and sample, we can derive the next quantities of interest
from that provided by the Hidex 300 SL:

**Live time**, :math:`t_l`:
    The actual time during which the detector is capable of recording events, excluding the dead time.
    It is expressed in seconds (`s`).
    It represents the effective counting time.
    It is calculated as the ratio of the measurement time, :math:`t_r`, and the dead time, :math:`t_d`:

    .. math::

        t_l=\frac{t_r}{t_d}

**Elapsed time**, :math:`t`:
    The total time from the start to the end of the measurement, including both live time and dead time.
    It is expressed in seconds (`s`).
    It is calculated as the difference between the end time of the measurement :math:`i`, :math:`t_{{end}_i}`
    and the end time of the first measurement, :math:`t_{{end}_{i=0}}`:

    .. math::

        t_i = t_{{end}_i}-t_{{end}_{i=0}}

**Counts**, :math:`C`:
    The total number of detected events during the measurement period, expressed in `counts`.
    It is the sum of all counts recorded over the entire measurement time.
    It is calculated as the product of the count rate, :math:`C_r`, and the live time, :math:`t_l`:

    .. math::

        C=C_r\cdot t_l

**Counts uncertainty**, :math:`u(C)`:
    The statistical uncertainty associated with the number of counts recorded, expressed in `counts`.
    It reflects the variability or error in the count measurement.
    It is computed as the square root of the counts, :math:`C`:

    .. math::

        u(C)=\sqrt{C}

    .. note::

        In radioactive decay and counting processes, the number of counts follows a Poisson distribution.
        For a Poisson-distributed variable, the mean (:math:`\lambda`) and the variance (:math:`\sigma^2`) are equal.
        The standard deviation, :math:`\sigma`, is the square root of the variance.
        Therefore, for a Poisson process, the standard deviation is :math:`\sigma=\sqrt{\lambda}`.

**Counts relative uncertainty**, :math:`u_r(C)`:
    The counts uncertainty expressed as a percentage of the total counts.
    It provides a relative measure of the uncertainty in the count data.
    It is calculated as the ratio of the counts uncertainty, :math:`u(C)`, and the counts, :math:`C`:

    .. math::

        u_r(C)=\frac{u(C)}{C}\cdot 100

Net quantities
^^^^^^^^^^^^^^

Next, we need to determine the net quantities.
These quantities are necessary to accurately determine the activity of the sample by eliminating the influence of background radiation.
Net quantities refer to the values obtained after subtracting background counts from the measured counts.

So, for each background measurement :math:`i` and its corresponding sample measurement :math:`i`,
we can derive the next net quantities of interest:

**Net counts**, :math:`C`:
    The total counts after subtracting the background counts, expressed in `counts`.
    It is calculated as the difference between the counts of the sample, :math:`C_s`, and the counts of the background, :math:`C_b`:

    .. math::

        C=C_s-C_b

**Net counts uncertainty**, :math:`u(C)`:
    The statistical uncertainty associated with the net counts, expressed in `counts`.
    It is calculated using the propagation of uncertainty formula for subtraction:

    .. math::

        u(C)=\sqrt{u^2(C_s)-u^2(C_b)}=\sqrt{(\sqrt{C_s})^2+(\sqrt{C_b})^2}=\sqrt{C_s+C_b}

**Net counts relative uncertainty**, :math:`u_r(C)`:
    The net counts uncertainty expressed as a percentage of the net counts.
    It is calculated dividing the net counts, :math:`C`, by the net counts uncartainty, :math:`u(C)`,
    and multiplying by 100 to express it as a percentage:

    .. math::

        u_r(C)=u(C)/C*100

Find more details about the uncertainty determination for activity measurements in this
`article by K. Kossert et al. <https://doi.org/10.1016/j.apradiso.2012.02.084>`_.
